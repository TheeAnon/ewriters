{"ast":null,"code":"import _regeneratorRuntime from\"D:/Japhe/Code/django-react/ewriters/react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/Japhe/Code/django-react/ewriters/react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{LOGIN_SUCCESS,LOGIN_FAIL,USER_LOADED_SUCCESS,USER_LOADED_FAIL,AUTHENTICATED_SUCCESS,AUTHENTICATED_FAIL,LOGOUT}from\"./types\";import axios from\"axios\";import res from\"react\";export var checkAuthenticated=function checkAuthenticated(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var config,body,_res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!localStorage.getItem(\"access\")){_context.next=15;break;}config={headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\"}};body=JSON.stringify({token:localStorage.getItem(\"access\")});_context.prev=3;_context.next=6;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/verify/\"),body,config);case 6:_res=_context.sent;if(_res.data.code!==\"token_not_valid\"){dispatch({type:AUTHENTICATED_SUCCESS});}else{dispatch({type:AUTHENTICATED_FAIL});}_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](3);dispatch({type:AUTHENTICATED_FAIL});case 13:_context.next=16;break;case 15:dispatch({type:AUTHENTICATED_FAIL});case 16:case\"end\":return _context.stop();}},_callee,null,[[3,10]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var load_user=function load_user(email,password){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var config,_res2;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!localStorage.getItem(\"access\")){_context2.next=15;break;}config={headers:{\"Content-Type\":\"application/json\",Authorisation:\"JWT \".concat(localStorage.getItem(\"access\")),Accept:\"application/json\"}};_context2.prev=2;_context2.next=5;return axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/users/me/\"),config);case 5:_res2=_context2.sent;dispatch({type:USER_LOADED_SUCCESS,payload:_res2.data});dispatch(load_user());_context2.next=12;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](2);case 12:dispatch({type:USER_LOADED_FAIL});_context2.next=16;break;case 15:dispatch({type:USER_LOADED_FAIL});case 16:case\"end\":return _context2.stop();}},_callee2,null,[[2,10]]);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var login=function login(email,password){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var config,body,_res3;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:config={headers:{\"Content-Type\":\"application/json\"}};body=JSON.stringify({email:email,password:password});_context3.prev=2;_context3.next=5;return axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/auth/jwt/create/\"),body,config);case 5:_res3=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:_res3.data});_context3.next=13;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](2);console.log(_context3.t0);dispatch({type:LOGIN_FAIL,payload:res.data});case 13:case\"end\":return _context3.stop();}},_callee3,null,[[2,9]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var logout=function logout(){return function(dispatch){dispatch({type:LOGOUT});};};","map":{"version":3,"names":["LOGIN_SUCCESS","LOGIN_FAIL","USER_LOADED_SUCCESS","USER_LOADED_FAIL","AUTHENTICATED_SUCCESS","AUTHENTICATED_FAIL","LOGOUT","axios","res","checkAuthenticated","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","config","body","_res","wrap","_callee$","_context","prev","next","localStorage","getItem","headers","Accept","JSON","stringify","token","post","concat","process","env","REACT_APP_API_URL","sent","data","code","type","t0","stop","_x","apply","arguments","load_user","email","password","_ref2","_callee2","_res2","_callee2$","_context2","Authorisation","get","payload","_x2","login","_ref3","_callee3","_res3","_callee3$","_context3","console","log","_x3","logout"],"sources":["D:/Japhe/Code/django-react/ewriters/react/src/actions/auth.js"],"sourcesContent":["import {\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAIL,\r\n  USER_LOADED_SUCCESS,\r\n  USER_LOADED_FAIL,\r\n  AUTHENTICATED_SUCCESS,\r\n  AUTHENTICATED_FAIL,\r\n  LOGOUT,\r\n} from \"./types\";\r\nimport axios from \"axios\";\r\nimport res from \"react\";\r\n\r\nexport const checkAuthenticated = () => async (dispatch) => {\r\n  if (localStorage.getItem(\"access\")) {\r\n    const config = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Accept: \"application/json\",\r\n      },\r\n    };\r\n    const body = JSON.stringify({ token: localStorage.getItem(\"access\") });\r\n    try {\r\n      const res = await axios.post(\r\n        `${process.env.REACT_APP_API_URL}/auth/jwt/verify/`,\r\n        body,\r\n        config\r\n      );\r\n      if (res.data.code !== \"token_not_valid\") {\r\n        dispatch({\r\n          type: AUTHENTICATED_SUCCESS,\r\n        });\r\n      } else {\r\n        dispatch({\r\n          type: AUTHENTICATED_FAIL,\r\n        });\r\n      }\r\n    } catch (error) {\r\n      dispatch({\r\n        type: AUTHENTICATED_FAIL,\r\n      });\r\n    }\r\n  } else {\r\n    dispatch({ type: AUTHENTICATED_FAIL });\r\n  }\r\n};\r\n\r\nexport const load_user = (email, password) => async (dispatch) => {\r\n  if (localStorage.getItem(\"access\")) {\r\n    const config = {\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorisation: `JWT ${localStorage.getItem(\"access\")}`,\r\n        Accept: \"application/json\",\r\n      },\r\n    };\r\n\r\n    try {\r\n      const res = await axios.get(\r\n        `${process.env.REACT_APP_API_URL}/auth/users/me/`,\r\n        config\r\n      );\r\n\r\n      dispatch({\r\n        type: USER_LOADED_SUCCESS,\r\n        payload: res.data,\r\n      });\r\n      dispatch(load_user());\r\n    } catch (err) {}\r\n    dispatch({\r\n      type: USER_LOADED_FAIL,\r\n    });\r\n  } else {\r\n    dispatch({\r\n      type: USER_LOADED_FAIL,\r\n    });\r\n  }\r\n};\r\n\r\nexport const login = (email, password) => async (dispatch) => {\r\n  const config = {\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n  };\r\n\r\n  const body = JSON.stringify({ email, password });\r\n\r\n  try {\r\n    const res = await axios.post(\r\n      `${process.env.REACT_APP_API_URL}/auth/jwt/create/`,\r\n      body,\r\n      config\r\n    );\r\n\r\n    dispatch({\r\n      type: LOGIN_SUCCESS,\r\n      payload: res.data,\r\n    });\r\n  } catch (err) {\r\n    console.log(err);\r\n    dispatch({\r\n      type: LOGIN_FAIL,\r\n      payload: res.data,\r\n    });\r\n  }\r\n};\r\n\r\nexport const logout = () => (dispatch) => {\r\n  dispatch({ type: LOGOUT });\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}